---
title: "Reproducible Research: Peer Assessment 1"
author: Rajeev Trikha
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Load the knitr package and set the global options for the code chunks
```{r echo=TRUE}
library(knitr)
opts_chunk$set(fig.width=12, fig.height=8, fig.path='figure/',echo=TRUE)
```


Read the activity data from the working directory

```{r}
data <- read.csv("activity.csv",stringsAsFactors = FALSE)
str(data)
```

There are 1440 (24*60) minutes in a day. The data has been taken at every 5 minutes interval for the month of October and November in 2012. Check that there are 288 entries (1440/5) for each date of the two months.

```{r}
table(data$date)
```

Conver the character date format into correct date format in the data frame
```{r}
data$date = as.Date(data$date,format("%Y-%m-%d"))
```
Check data has been properly transformed to reflect dates correctly
```{r}
str(data)
```
## What is mean total number of steps taken per day?

Establish total number of steps taken each day, whilst ignoring NAs

```{r}
library(dplyr)
dailyTotalSteps <- group_by(data,date) %>%
                            summarise(sum(steps, na.rm=TRUE))
```

Plot the histogram of total steps taken each day using 15 breaks and show mean and median steps.
```{r totalStepsPlot}
names(dailyTotalSteps)[2] <- "steps"
daily_mean <- round(mean(dailyTotalSteps$steps),0)
daily_median <- round(median(dailyTotalSteps$steps),0)
hist(dailyTotalSteps$steps,breaks=15,main="Number of steps taken per day",xlab="Total steps",col="grey")
abline(v=daily_mean, lwd = 2, col = "blue")
abline(v=daily_median, lwd = 2, col = "red")
legend("topright",fill=c("blue","red"),legend=c("mean","median"))
```

The mean value is `r daily_mean` and the median value is `r daily_median`. Check using 5 point summary
```{r}
summary(dailyTotalSteps$steps)
```

## What is the average daily activity pattern?

Establish average number of steps taken during each interval, whilst ignoring NAs

```{r}
stepsByInterval <- group_by(data,interval) %>%
                            summarise(mean(steps, na.rm=TRUE))
str(stepsByInterval)
```

Plot the average daily activity pattern

```{r averageSteps}
names(stepsByInterval)[2] <- "steps"
# Find maximum interval row and the values
maxrow <- which.max(stepsByInterval$steps)
maxInterval <- stepsByInterval[maxrow,1]
maxSteps <- stepsByInterval[maxrow,2]
#plot lines graph
plot(stepsByInterval$interval,stepsByInterval$steps,main="Average steps per interval",xlab="5 minute Intervals",ylab="Average Steps",pch="")
lines(stepsByInterval$interval,stepsByInterval$steps)
```

The maximum average steps of `r maxSteps` occurs in the interval `r maxInterval`.

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
